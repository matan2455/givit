{%extends 'base.html'%}

{%block content%}
<head>
    <script>
        function set_for_coordination(item,friend_id, request_id, pickup_location, drop_off_location, image_url) {
            document.getElementById("coordination-form").hidden = false;
            document.getElementById("coordination-div").hidden = false;
            
            document.getElementById("item").value =  item;
            document.getElementById("friend_id").value =  friend_id;
            document.getElementById("request_id").value =  request_id;
            document.getElementById("pickup_location").value =  pickup_location;
            document.getElementById("drop_off_location").value =  drop_off_location;
            document.getElementById("image_url").src = image_url;

            document.getElementById("item").placeholder = "item: " + item;
            document.getElementById("friend_id").placeholder = "friend_id: " + friend_id;
            document.getElementById("request_id").placeholder +=  "request_id: " + request_id;
            document.getElementById("pickup_location").placeholder +=  "pickup_location:" + pickup_location;
            document.getElementById("drop_off_location").placeholder +=  "drop_off_location:" + drop_off_location;
        }

        function hide_form(){
            document.getElementById("coordination-form").hidden = true;
            document.getElementById("coordination-div").hidden = true;
        }

        function enableInputs(){
            inputs = document.getElementByType('input');
            console.log(inputs);
            inputs.foreach(input => input.disabled = "false");
        }

        function implement_filters(){
            //TODO - implement chosen filters 
        }
    </script>

</head>
    <div id="stripe">
        <button type='button' id="newColors" style="align-self:left" onclick="location.href='/shipmentTable.html'">get coordinated items</button>
        <button type='button' id="newColors" style="align-self:left" onclick="implement_filters()">implement filters</button>
        <span class="answer"></span>
        <select id="itemButton" name="item" size="1" style="border:none; display: inline-block;margin-left: 40px;">
            <option value="">Item Type</option>
            <option value="bed">Bed</option>
            <option value="desk">desk</option>
            <option value="TV">TV</option>
            <option value="washing machine">washing machine</option>
            <option value="bed">laptop</option>
            <option value="fridge">fridge</option>
            <option value="oven">oven</option>
            <option value="sofa">sofa</option>
            <option value="microwave oven">microwave oven</option>
            <option value="chair">chair</option>
            <option value="computer screen">computer screen</option>
            <option value="keyboard">keyboard</option>
        </select>
        <select id="cityButton" name="city" size="1" style="border:none; margin-left: 40px;">
            <option value="">City</option>
            <option value="Tel Aviv">Tel Aviv</option>
            <option value="Herzeliya">Herzeliya</option>
            <option value="Natanya">Natanya</option>
            <option value="Jerusalem">Jerusalem</option>
            <option value="Ranana">Ranana</option>
            <option value="Kfar sava">Kfar sava</option>
            <option value="Haifa">Haifa</option>
            <option value="Rosh Haain">Rosh Haain</option>
            <option value="Modiin">Modiin</option>
            <option value="Beer Sheva">Beer Sheva</option>
        </select>
    </div>

    <form method='POST' action="/coordinate/file" style="margin:auto; padding:3px; width:30%"> {%csrf_token%}
        <div class="row" style="display:inline">
            <input type="date" class="form-control mb-2" name="date" id="inlineFormInput" placeholder="choose date" style="width:50%">
            <button type="submit" class="btn btn-primary mb-2" style="width:50%">create brief</button>
        </div>
    </form>

     <form method='POST' action="/coordinate/download_file" style="margin:auto; padding:3px;  width:30%"> {%csrf_token%}
        <div class="row">
            <button type="submit" class="btn btn-success mb-2" style="width:55%">download brief</button>
        </div>
    </form>



{% for item in matchedItems %}
    {% for request in openRequests %}  
       {% if item.request_id == request.id %}
            <!-- TODO - add user details --> 
            {% comment %} {% for user in users %} {% endcomment %} 
                <div>
                    <ul>
                        <table class="table table-bordered table-striped" style="width:85%; margin-top:20px">
                            <tr>
                                <td>Item type</td>
                                <td>pick up</td>
                                <td>drop off</td>
                                <td>URL</td>
                                <td>Pic</td>
                                <td>coordinate form</td> 
                            </tr>
                            <tr>
                                <td>{{item.title}}</td>
                                <td>{{item.city}}</td>
                                <td>{{item.city}}</td>
                                <td><a href="{{item.url}}">link</a></td>
                                <td><img src="{{item.picture}}" style='width:150px; height:150px'/></td>
                                <td><button type='input' class="btn btn-primary"     
                                onclick="set_for_coordination('{{item.title}}','{{request.friend_id}}', '{{item.request_id}}', '{{item.city}}', '{{item.city}}','{{item.picture}}');">
                                open</button>
                                <button type='input' class="btn btn-danger"     
                                        style="margin-left:10px" onclick="hide_form();">close</button>
                                </td>
                            </tr>
                        </table>
                    </ul>
                </div>

                <!--  hidden form - appears only when requested -->  
                <div class="jumbotron center" id="coordination-div" hidden="true" style="margin-bottom:10%; margin:auto; width:60%; border:3px solid white; padding:10px; background:lavender">
                    <h1 class="display-4" style="text-align:center">COORDINATION FORM</h1> 
                    <h5 style="text-align:center">Insert Dates and times for transfer after coordinating with the following contacts:</h5> 
                    <form  method="POST" hidden="true" id="coordination-form" style="margin: auto; width:60%; margin-top:7%">    {%csrf_token%}
                        <div  class="row">
                            <div  class="col" >
                                    <lable>coordination details</lable>
                                    <input id="friend_id" name="friend_id" readonly>
                                    <input id ="request_id"  name="request_id" readonly> 
                                    <input id ="item" name="item" readonly> 
                                    <input id ="pickup_location" name="pickup_location" readonly> 
                                    <input id ="drop_off_location" name="drop_off_location" readonly> 
                            </div>
                            <div class="col" >
                                    <lable>insert date and time</lable>
                                    <inpuet id="special_notes" type="text" name="special_notes"> 
                                    <input id="date" placeholder="insert date of transfer" type="date" name="date">
                                    <input id="pickup_time" placeholder="insert pick up time" type="time" name="pickup_time" step="1">
                                    <input id="drop_off_time" placeholder="insert drop off time" type="time" name="drop_off_time" step="1">
                                    <button class="btn-success"  onclick="enableInputs()"  type="submit" value="send" style="height:24%;width:50%; border:solid white 2px; margin-top:10px">schedual</button>
                                    <img class="card-img-top" src="" id="image_url" alt="Card image cap" style="border:solid white 2px; self-align:center;height:30%; width:40%">
                            </div>
                        </div>
                    </form>
                </div>
            {% comment %} {%endfor%} {% endcomment %}
        {% endif %}
    {%endfor%}
{%endfor%}



{%endblock%}
